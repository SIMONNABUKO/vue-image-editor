(function(y,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(y=typeof globalThis<"u"?globalThis:y||self,e(y.VueImageEditor={},y.Vue))})(this,function(y,e){"use strict";const Oe="",N=(s,o)=>{const a=s.__vccOpts||s;for(const[t,i]of o)a[t]=i;return a},F={name:"EmojiPicker",emits:["select"],setup(s,{emit:o}){const a=["😀","😃","😄","😁","😆","😅","😂","🤣","😊","😇","🙂","🙃","😉","😌","😍","🥰","😘","😗","😙","😚","😋","😛","😝","😜","🤪","🤨","🧐","🤓","😎","🤩","🥳","😏","😒","😞","😔","😟","😕","🙁","☹️","😣","😖","😫","😩","🥺","😢","😭","😤","😠","😡","🤬","🤯","😳","🥵","🥶","😱","😨","😰","😥","😓","🤗","🤔","🤭","🤫","🤥","😶","😐","😑","😬","🙄","😯","😦","😧","😮","😲","🥱","😴","🤤","😪","😵","🤐","🥴","🤢","🤮","🤧","😷","🤒","🤕","🤑","🤠","😈","👿","👹","👺","🤡","💩","👻","💀","☠️","👽","👾"],t=e.ref(""),i=e.computed(()=>t.value?a.filter(c=>c.includes(t.value)):a);return{search:t,filteredEmojis:i,selectEmoji:c=>{o("select",{i:c})}}}},v={class:"emoji-picker"},z={class:"emoji-list"},R=["onClick"];function O(s,o,a,t,i,x){return e.openBlock(),e.createElementBlock("div",v,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[0]||(o[0]=c=>t.search=c),type:"text",placeholder:"Search emoji...",class:"w-full px-2 py-1 mb-2 bg-[#1a1b1f] text-white rounded border border-white/10"},null,512),[[e.vModelText,t.search]]),e.createElementVNode("div",z,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.filteredEmojis,c=>(e.openBlock(),e.createElementBlock("button",{key:c,onClick:n=>t.selectEmoji(c),class:"emoji-button"},e.toDisplayString(c),9,R))),128))])])}const U=N(F,[["render",O],["__scopeId","data-v-c9042253"]]);function X(s,o,a,t,i){s.filter=`blur(${i}px)`,s.drawImage(o,a.x,a.y,t.width,t.height,a.x,a.y,t.width,t.height),s.filter="none"}function Y(s,o,a,t){const i=s.getImageData(o.x,o.y,a.width,a.height);for(let x=0;x<a.height;x+=t)for(let c=0;c<a.width;c+=t){const n=(x*a.width+c)*4,d=i.data[n],g=i.data[n+1],T=i.data[n+2];for(let p=0;p<t;p++)for(let u=0;u<t;u++)if(c+u<a.width&&x+p<a.height){const w=((x+p)*a.width+(c+u))*4;i.data[w]=d,i.data[w+1]=g,i.data[w+2]=T}}s.putImageData(i,o.x,o.y)}function L(){return[{position:"nw",style:{top:"-5px",left:"-5px",cursor:"nwse-resize"}},{position:"ne",style:{top:"-5px",right:"-5px",cursor:"nesw-resize"}},{position:"sw",style:{bottom:"-5px",left:"-5px",cursor:"nesw-resize"}},{position:"se",style:{bottom:"-5px",right:"-5px",cursor:"nwse-resize"}}]}function H(s,o,a,t,i){switch(s){case"nw":a.width+=o.x-t,a.height+=o.y-i,o.x=t,o.y=i;break;case"ne":a.width=t-o.x,a.height+=o.y-i,o.y=i;break;case"sw":a.width+=o.x-t,a.height=i-o.y,o.x=t;break;case"se":a.width=t-o.x,a.height=i-o.y;break}return{framePosition:o,frameSize:a}}const Ue="",q={name:"VueImageEditor",components:{EmojiPicker:U},props:{isOpen:{type:Boolean,required:!0},imageUrl:{type:String,required:!0},tools:{type:Array,default:()=>["blur","pixelate","text","emoji"]}},emits:["close","save"],setup(s,{emit:o}){const a=e.ref(null),t=e.ref(null),i=e.ref(null),x=e.ref(null),c=e.ref(null),n=e.ref("blur"),d=e.ref(!1),g=e.ref(!1),T=e.ref(!1),p=e.ref(!1),u=e.ref(!1),w=e.ref(null),D=e.ref(""),_=e.ref("#ffffff"),B=e.ref(24),V=e.ref(5),f=e.ref({x:0,y:0}),h=e.ref({width:100,height:100}),C=e.ref({x:0,y:0}),E=e.ref([]),k=e.ref([]),de=e.computed(()=>[{name:"blur",label:"Blur"},{name:"pixelate",label:"Pixelate"},{name:"text",label:"Text"},{name:"emoji",label:"Emoji"}].filter(r=>s.tools.includes(r.name))),ge=L(),me=e.computed(()=>({left:`${f.value.x}px`,top:`${f.value.y}px`,width:`${h.value.width}px`,height:`${h.value.height}px`})),fe=l=>({left:`${l.x}px`,top:`${l.y}px`}),xe=l=>({left:`${l.x}px`,top:`${l.y}px`,fontSize:`${l.size}px`}),b=async()=>{t.value=await b(a.value,i.value,s.imageUrl)},ye=l=>{n.value=l,d.value=!0,l==="blur"||l==="pixelate"?g.value=!0:g.value=!1},pe=l=>{T.value=!0,M(l)},M=l=>{if(!T.value)return;const r=a.value.getBoundingClientRect(),m=l.clientX-r.left,j=l.clientY-r.top;(n.value==="blur"||n.value==="pixelate")&&(f.value={x:m,y:j},h.value={width:100,height:100})},ue=()=>{T.value=!1},he=l=>{p.value=!0;const r=a.value.getBoundingClientRect();C.value={x:l.clientX-r.left-f.value.x,y:l.clientY-r.top-f.value.y}},Ee=l=>{if(!p.value)return;const r=a.value.getBoundingClientRect();f.value={x:l.clientX-r.left-C.value.x,y:l.clientY-r.top-C.value.y}},we=()=>{p.value=!1},ke=l=>{u.value=!0,w.value=l},Te=l=>{if(!u.value)return;const r=a.value.getBoundingClientRect(),m=l.clientX-r.left,j=l.clientY-r.top,S=H(w.value,f.value,h.value,m,j);f.value=S.framePosition,h.value=S.frameSize},De=()=>{u.value=!1,w.value=null},be=()=>{t.value.drawImage(c.value,0,0,a.value.width,a.value.height),n.value==="blur"?X(t.value,a.value,f.value,h.value,V.value):n.value==="pixelate"&&Y(t.value,f.value,h.value,V.value)},_e=()=>{D.value&&(E.value.push({text:D.value,x:50,y:50,color:_.value,size:B.value}),D.value="")},Be=(l,r)=>{const m=E.value[l];m.isDragging=!0,m.dragStartX=r.clientX-m.x,m.dragStartY=r.clientY-m.y},Ve=l=>{E.value.forEach(r=>{r.isDragging&&(r.x=l.clientX-r.dragStartX,r.y=l.clientY-r.dragStartY)})},Ce=()=>{E.value.forEach(l=>{l.isDragging=!1})},je=l=>{const r=E.value[l];D.value=r.text,_.value=r.color,B.value=r.size,E.value.splice(l,1)},Ne=l=>{E.value.splice(l,1)},Ie=l=>{k.value.push({emoji:l.i,x:50,y:50,size:24})},Me=(l,r)=>{const m=k.value[l];m.isDragging=!0,m.dragStartX=r.clientX-m.x,m.dragStartY=r.clientY-m.y},Se=l=>{k.value.forEach(r=>{r.isDragging&&(r.x=l.clientX-r.dragStartX,r.y=l.clientY-r.dragStartY)})},Fe=()=>{k.value.forEach(l=>{l.isDragging=!1})},ve=l=>{k.value.splice(l,1)},ze=()=>{o("close")},Re=()=>{const l=a.value.toDataURL();o("save",l)};return e.onMounted(async()=>{s.isOpen&&await b()}),e.watch(()=>s.isOpen,async l=>{l&&await b()}),e.watch(()=>s.imageUrl,async()=>{s.isOpen&&await b()}),{canvas:a,canvasContainer:i,blurFrame:x,currentTool:n,showToolOptions:d,showBlurFrame:g,textInput:D,textColor:_,textSize:B,effectIntensity:V,framePosition:f,frameSize:h,textItems:E,emojiItems:k,availableTools:de,resizeHandles:ge,blurFrameStyle:me,getTextItemStyle:fe,getEmojiItemStyle:xe,selectTool:ye,startDrawing:pe,draw:M,stopDrawing:ue,startFrameDrag:he,dragFrame:Ee,stopFrameDrag:we,startResize:ke,resize:Te,stopResize:De,applyEffect:be,addText:_e,startTextDrag:Be,dragText:Ve,stopTextDrag:Ce,editText:je,deleteText:Ne,addEmoji:Ie,startEmojiDrag:Me,dragEmoji:Se,stopEmojiDrag:Fe,deleteEmoji:ve,handleClose:ze,handleSave:Re}}},A={key:0,class:"vue-image-editor"},G={class:"editor-container"},J={class:"toolbar"},K=["onClick"],Q={class:"canvas-container",ref:"canvasContainer"},W=["onMousedown","onTouchstart"],Z=["onMousedown","onTouchstart"],P=["onClick"],$=["onClick"],ee=["onMousedown","onTouchstart"],te=["onClick"],oe={key:0,class:"tool-options"},ne={key:0},le={key:1},ae={key:2},re=["min","max"],ie={class:"actions"};function se(s,o,a,t,i,x){const c=e.resolveComponent("EmojiPicker");return a.isOpen?(e.openBlock(),e.createElementBlock("div",A,[e.createElementVNode("div",G,[e.createElementVNode("div",J,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.availableTools,n=>(e.openBlock(),e.createElementBlock("button",{key:n.name,onClick:d=>t.selectTool(n.name),class:e.normalizeClass({active:t.currentTool===n.name})},e.toDisplayString(n.label),11,K))),128))]),e.createElementVNode("div",Q,[e.createElementVNode("canvas",{ref:"canvas",onMousedown:o[0]||(o[0]=(...n)=>t.startDrawing&&t.startDrawing(...n)),onMousemove:o[1]||(o[1]=(...n)=>t.draw&&t.draw(...n)),onMouseup:o[2]||(o[2]=(...n)=>t.stopDrawing&&t.stopDrawing(...n)),onMouseleave:o[3]||(o[3]=(...n)=>t.stopDrawing&&t.stopDrawing(...n)),onTouchstart:o[4]||(o[4]=(...n)=>t.startDrawing&&t.startDrawing(...n)),onTouchmove:o[5]||(o[5]=(...n)=>t.draw&&t.draw(...n)),onTouchend:o[6]||(o[6]=(...n)=>t.stopDrawing&&t.stopDrawing(...n))},null,544),t.showBlurFrame?(e.openBlock(),e.createElementBlock("div",{key:0,ref:"blurFrame",class:"blur-frame",style:e.normalizeStyle(t.blurFrameStyle),onMousedown:o[7]||(o[7]=(...n)=>t.startFrameDrag&&t.startFrameDrag(...n)),onTouchstart:o[8]||(o[8]=(...n)=>t.startFrameDrag&&t.startFrameDrag(...n))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.resizeHandles,n=>(e.openBlock(),e.createElementBlock("div",{key:n.position,class:"resize-handle",style:e.normalizeStyle(n.style),onMousedown:e.withModifiers(d=>t.startResize(n.position),["stop"]),onTouchstart:e.withModifiers(d=>t.startResize(n.position),["stop"])},null,44,W))),128))],36)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.textItems,(n,d)=>(e.openBlock(),e.createElementBlock("div",{key:d,class:"text-item",style:e.normalizeStyle(t.getTextItemStyle(n)),onMousedown:g=>t.startTextDrag(d,g),onTouchstart:g=>t.startTextDrag(d,g)},[e.createElementVNode("div",{style:e.normalizeStyle({color:n.color,fontSize:`${n.size}px`})},e.toDisplayString(n.text),5),e.createElementVNode("button",{onClick:g=>t.editText(d),class:"edit-button"},"Edit",8,P),e.createElementVNode("button",{onClick:g=>t.deleteText(d),class:"delete-button"},"Delete",8,$)],44,Z))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.emojiItems,(n,d)=>(e.openBlock(),e.createElementBlock("div",{key:d,class:"emoji-item",style:e.normalizeStyle(t.getEmojiItemStyle(n)),onMousedown:g=>t.startEmojiDrag(d,g),onTouchstart:g=>t.startEmojiDrag(d,g)},[e.createTextVNode(e.toDisplayString(n.emoji)+" ",1),e.createElementVNode("button",{onClick:g=>t.deleteEmoji(d),class:"delete-button"},"Delete",8,te)],44,ee))),128))],512),t.showToolOptions?(e.openBlock(),e.createElementBlock("div",oe,[t.currentTool==="text"?(e.openBlock(),e.createElementBlock("div",ne,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[9]||(o[9]=n=>t.textInput=n),placeholder:"Enter text"},null,512),[[e.vModelText,t.textInput]]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[10]||(o[10]=n=>t.textColor=n),type:"color"},null,512),[[e.vModelText,t.textColor]]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[11]||(o[11]=n=>t.textSize=n),type:"range",min:"12",max:"72"},null,512),[[e.vModelText,t.textSize]]),e.createElementVNode("button",{onClick:o[12]||(o[12]=(...n)=>t.addText&&t.addText(...n))},"Add Text")])):e.createCommentVNode("",!0),t.currentTool==="emoji"?(e.openBlock(),e.createElementBlock("div",le,[e.createVNode(c,{onSelect:t.addEmoji},null,8,["onSelect"])])):e.createCommentVNode("",!0),t.currentTool==="blur"||t.currentTool==="pixelate"?(e.openBlock(),e.createElementBlock("div",ae,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[13]||(o[13]=n=>t.effectIntensity=n),type:"range",min:(t.currentTool==="pixelate",1),max:(t.currentTool==="pixelate",20),onInput:o[14]||(o[14]=(...n)=>t.applyEffect&&t.applyEffect(...n))},null,40,re),[[e.vModelText,t.effectIntensity]])])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.createElementVNode("div",ie,[e.createElementVNode("button",{onClick:o[15]||(o[15]=(...n)=>t.handleClose&&t.handleClose(...n))},"Cancel"),e.createElementVNode("button",{onClick:o[16]||(o[16]=(...n)=>t.handleSave&&t.handleSave(...n))},"Save")])])])):e.createCommentVNode("",!0)}const I=N(q,[["render",se],["__scopeId","data-v-dfac2ae7"]]),ce={install:s=>{s.component("VueImageEditor",I)}};y.VueImageEditor=I,y.default=ce,Object.defineProperties(y,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
